<!DOCTYPE html>
<html lang="en">
    <head>
        <style>
            body,html{
                height: 100%;
                margin: 0;
            }
            .bg{
                background-image: url("background.png");
                height: 100%;
                background-position: center;
                background-repeat: no-repeat;
                background-size: cover;
            }
            button{
                background-color: wheat;
                border-radius: 12px;
                border-style: solid;
                opacity: 0.8;
            }
            .clickbtn{
                height: 150px;
                width: 200px;
            }
            .clickbtn_ext{
                height: 150px;
                width: 50px;
            }
            #wrapper{
                text-align: center;
            }
            .d-none, .d-none *{
                display: none;
            }
        
            .p-abs{
                position: absolute;
            }
        </style>
        <title>smaaaaaak!!</title>
    </head>
    <body>
        <div class="bg">
            <div class= "p-abs">
                <div id="debug" class="d-none">
                    <input type="number" id="incnum" value="0">
                    <button onclick='increaseNum(Number(document.getElementById("incnum").value))'>CHEAT +Num</button>
                    <button onclick='num=Number(document.getElementById("incnum").value);update();'>CHEAT =Num</button>
                    <br><br>
                    <input type="number" id="inccrush" value="0">
                    <button onclick='crush+=Number(document.getElementById("inccrush").value);update();'>CHEAT +Crush</button>
                    <button onclick='crush=Number(document.getElementById("inccrush").value);update();'>CHEAT =Crush</button>
                    <br><br>
                    <input type="number" id="incCPow" value="0">
                    <button onclick='clicker_level+=Number(document.getElementById("incCPow").value);update();'>CHEAT +CPow</button>
                    <button onclick='clicker_level=Number(document.getElementById("incCPow").value);update();'>CHEAT =CPow</button>
                    <br><br>
                </div>
                <button id="enable_debug" onclick='debug()'>enable_cheats</button>
            </div>
            <div id = "wrapper">

                <div id="number_sek">
                    <h3>Eaten smaks: <span id = "number">0</span></h3>
                    <button class = "clickbtn" id="numberbtn" onclick="increaseNum()">Smak</button>
                </div>

                <div id="crusher_sek" class="d-none">
                    <h3>crushers: <span id = "crusher">0</span></h3>
                    <button class = "clickbtn" id="crusherbtn" onclick="increaseCrush()">Crush it!!!</button>
                    <button class = "clickbtn_ext" id="crusherbtn_ext" onclick="increaseCrush(10)">+10</button>
                </div>

                <div id="click_improver">
                    <h3>ClickPower: <span id = "click_improvements">0</span></h3>
                    <button class = "clickbtn" id="clickimpbtn" onclick="increaseClickPow()">More Click Power</button>
                </div>

            </div>
        </div>
        
        <script>

        var cost=[];
        cost['crush']=100;
        cost['ClickPow']=10;

        var num = 0;
        var crush = -1;
        var clicker_level = 1;

            //initialisierung
            window.onload=function(){
                //setInterval(autoclick,1000);
                setInterval(save, 5000);

                //spielstand aus cache laden
                var stored = localStorage['smak_clicker'];
                if (stored){
                    myVar = JSON.parse(stored); 
                    num = myVar["num"];
                    crush = myVar["crush"];
                    clicker_level = myVar["clicker_level"];
                    if(num >= cost['crush']){
                        document.getElementById("crusher_sek").classList.remove("d-none");
                    }
                }
                update();
            }
            
            function save(){
                var jstuff  = {
                    "clicker_level": clicker_level, 
                    "crush": crush,
                    "num": num
                }
                localStorage['smak_clicker'] = JSON.stringify(jstuff);
            }
          
            //after every btn click
            function update(){
                document.getElementById("number").innerHTML = num;
                document.getElementById("crusher").innerHTML = crush;
                document.getElementById("click_improvements").innerHTML = clicker_level;
                if(num<cost['crush']){
                    document.getElementById("crusherbtn").disabled=true;
                }else{
                    document.getElementById("crusherbtn").disabled=false;
                }
                if(num<cost['crush']*10){
                    document.getElementById("crusherbtn_ext").disabled=true;
                }else{
                    document.getElementById("crusherbtn_ext").disabled=false;
                }
            }
            
            function increaseClickPow(){
                if(num > cost['ClickPow']*clicker_level){
                    num -= cost['ClickPow']*clicker_level;
                    clicker_level++;
                    update();
                }
            }

            //numbersection
            function increaseNum(n=1){
                if(crush>0){
                    num+=crush;
                }
                num+=n;
                num += clicker_level;
                if(crush == -1 && num >= cost['crush']){
                    crusher();
                }
                update();
            }
/*
            //autoclickcounter
            function autoclick(){
                if(crush>0){
                    num+=crush;
                }
                update();
            }
*/
            //crushersection:
            function crusher(){
                crush=0;
                document.getElementById("crusher_sek").classList.remove("d-none");
            }

            function increaseCrush(n=1){
                crush+=n;
                num-=(cost['crush']*n);
                update();
            }
            //end_crushersection
            
            //debug
            function debug(){
                let btn=document.getElementById("enable_debug");
                console.log(btn);
                if(btn.innerHTML=="enable_cheats"){
                    console.log(true);
                    document.getElementById("debug").classList.remove("d-none");
                    btn.innerHTML="disable_cheats";
                }else{
                    console.log(false);
                    document.getElementById("debug").classList.add("d-none");
                    btn.innerHTML="enable_cheats";
                }
            }
        </script>
    </body>
</html>