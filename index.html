<!DOCTYPE html>
<html lang="en">
    <head>
        <style>
            .clickbtn{
                height: 150px;
                width: 200px;
            }
            .clickbtn_ext{
                height: 150px;
                width: 50px;
            }
            #wrapper{
                text-align: center;
            }
            .d-none{
                display: none;
            }
            #debug, #enable_debug{
                position: absolute;
            }
        </style>
        <title>smaaaaaak!!</title>
    </head>
    <body>
        <div id="enable_debug" class="">
            <button onclick='debug()'>enable_cheats</button>
        </div>
        <div id="debug" class="d-none">
            <input type="number" id="incnum" value="0">
            <button onclick='increaseNum(Number(document.getElementById("incnum").value))'>CHEAT +Num</button>
            <button onclick='num=Number(document.getElementById("incnum").value);update();'>CHEAT =Num</button>
            <br><br>
            <input type="number" id="inccrush" value="0">
            <button onclick='crush+=Number(document.getElementById("inccrush").value);update();'>CHEAT +Crush</button>
            <button onclick='crush=Number(document.getElementById("inccrush").value);update();'>CHEAT =Crush</button>
        </div>
        <div id = "wrapper">

            <div id="number_sek">
                <h3>Eaten smaks: <span id = "number">0</span></h3>
                <button class = "clickbtn" id="numberbtn" onclick="increaseNum()">Smak</button>
            </div>

            <div id="crusher_sek" class="d-none">
                <h3>crushers: <span id = "crusher">0</span></h3>
                <button class = "clickbtn" id="crusherbtn" onclick="increaseCrush()">Crush it!!!</button>
                <button class = "clickbtn_ext" id="crusherbtn_ext" onclick="increaseCrush(10)">+10</button>
            </div>

            <div id="click_improver">
                <h3>ClickPower: <span id = "click_improvements">0</span></h3>
                <button class = "clickbtn" id="clickimpbtn" onclick="increaseClickPow()">More Click Power</button>
            </div>

        </div>

        <script>

        var cost=[];
        cost['crush']=100;
        cost['ClickPow']=10;

        var num = 0;
        var crush = -1;
        var clicker_level = 1;

            //initialisierung
            window.onload=function(){
                setInterval(autoclick,1000);
                setInterval(save, 5000);

                //spielstand aus cache laden
                var stored = localStorage['smak_clicker'];
                if (stored){
                   myVar = JSON.parse(stored); 
                   num = myVar["num"];
                   crush = myVar["crush"];
                   clicker_level = myVar["clicker_level"];
                   document.getElementById("crusher_sek").classList=[];
                }
                update();
            }
            
            function save(){
                var jstuff  = {
                    "clicker_level": clicker_level, 
                    "crush": crush,
                    "num": num
                }
                localStorage['smak_clicker'] = JSON.stringify(jstuff);
            }
          
            //after every btn click
            function update(){
                document.getElementById("number").innerHTML = num;
                document.getElementById("crusher").innerHTML = crush;
                document.getElementById("click_improvements").innerHTML = clicker_level;
                if(num<cost['crush']){
                    document.getElementById("crusherbtn").disabled=true;
                }else{
                    document.getElementById("crusherbtn").disabled=false;
                }
                if(num<cost['crush']*10){
                    document.getElementById("crusherbtn_ext").disabled=true;
                }else{
                    document.getElementById("crusherbtn_ext").disabled=false;
                }
            }
            
            function increaseClickPow(){
                if(num > cost['ClickPow']){
                    num -= cost['ClickPow'];
                    clicker_level++;
                    update();
                }
            }

            //numbersection
            function increaseNum(n=1){
                if(crush>0){
                    num+=crush;
                }
                num+=n;
                num += clicker_level;
                if(crush == -1 && num >= cost['crush']){
                    crusher();
                }
                update();
            }
/*
            //autoclickcounter
            function autoclick(){
                if(crush>0){
                    num+=crush;
                }
                update();
            }
*/
            //crushersection:
            function crusher(){
                crush=0;
                document.getElementById("crusher_sek").classList=[];
            }

            function increaseCrush(n=1){
                crush+=n;
                num-=(cost['crush']*n);
                update();
            }
            //end_crushersection
            
            //debug
            function debug(){
                document.getElementById("debug").classList.remove("d-none");
                document.getElementById("enable_debug").classList.add("d-none");
            }
        </script>
    </body>
</html>